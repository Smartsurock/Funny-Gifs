(()=>{"use strict";(new class{constructor(){this.input=document.querySelector(".input"),this.searchBtn=document.querySelector(".search__btn"),this.trendBtn=document.querySelector("#trending"),this.randomBtn=document.querySelector("#random"),this.translateBtn=document.querySelector("#translate"),this.searchBtn=document.querySelector(".search__btn"),this.mainContent=document.querySelector(".main__content"),this.offset=0,this.infiniteContent="trending",this.categoryImg=!1,this.searchParam="",this.api=new class{constructor(){this.baseUrl="https://api.giphy.com/v1/",this.apiKey="?api_key=qa1T0vszg1yiWakAJFj98YbZt20VG1Yv"}async getResponse(t,e="",i="",n=25,s=0){let a=await fetch(`${this.baseUrl}gifs/${t}${i}${this.apiKey}${e}&limit=${n}&offset=${s}&rating=g&lang=en`);return await a.json()}},this.getCategories(),this.addClickEvent(),this.infiniteScroll()}addActive(t){document.querySelectorAll(".sidebar__endpoint").forEach((t=>{t.classList.remove("active")})),t&&t.classList.add("active")}req(){this.input.style.border="1px solid red",this.input.focus(),this.input.onblur=()=>{this.input.style.border="1px solid black"}}searchEvent(t,e,i){if(""==this.input.value)return this.req();this.offset+=25,this.categoryImg=!1,this.mainContent.innerHTML="",this.searchParam=`&${e}=${this.input.value}`,this.infiniteContent=t,this.setContent(this.infiniteContent,this.searchParam,"",25,this.offset,this.categoryImg),this.input.value="",i&&this.input.blur()}addClickEvent(){this.searchBtn.addEventListener("click",(()=>{this.searchEvent(this.searchBtn.id,"q"),this.addActive()})),this.input.addEventListener("keydown",(t=>{"Enter"==t.key&&(this.searchEvent(this.searchBtn.id,"q",!0),this.addActive())})),this.trendBtn.addEventListener("click",(()=>{this.offset+=25,this.mainContent.innerHTML="",this.categoryImg=!1,console.log(this.searchParam),this.infiniteContent=this.trendBtn.id,this.addActive(this.trendBtn),this.setContent(this.trendBtn.id,"","",25,this.offset,this.categoryImg)})),this.randomBtn.addEventListener("click",(()=>{this.mainContent.innerHTML="",this.setContent(this.randomBtn.id),this.addActive(this.randomBtn)})),this.translateBtn.addEventListener("click",(()=>{this.searchEvent(this.translateBtn.id,"s"),this.addActive(this.translateBtn)}))}async setContent(t,e,i,n,s,a){let r=await this.api.getResponse(t,e,i,n,s);Array.isArray(r.data)||(r.data=[r.data]),this.mountImg(r.data,a)}async getCategories(){let t=await this.api.getResponse("categories"),e="";t.data.map((t=>{e+=`<div class="sidebar__endpoint" data-name="/${t.name_encoded}">\n        <span>${t.name[0].toUpperCase()+t.name.slice(1)}</span>\n        <span>${t.name[0].toUpperCase()+t.name.slice(1)}</span>\n      </div>`})),this.mountCategoryBtns(e),this.addBindEvent()}mountCategoryBtns(t){this.sideBar=document.querySelector(".sidebar"),this.sideBar.insertAdjacentHTML("beforeend",t)}addBindEvent(){this.selectors=document.querySelectorAll("[data-name]"),this.selectors.forEach((t=>{t.addEventListener("click",(()=>{this.addActive(t),this.offset=0;let e=t.getAttribute("data-name");this.mainContent.innerHTML="",this.categoryImg=!0,this.infiniteContent="categories"+e,this.setContent("categories","",e,25,this.offset,this.categoryImg),this.offset=25}))}))}start(){this.setContent(this.infiniteContent),this.addActive(this.trendBtn),this.offset+=25}infiniteScroll(){document.addEventListener("scroll",(()=>{let t=!1;this.mainContent.getBoundingClientRect().bottom<=document.documentElement.clientHeight+1&&!t&&(t=!0,this.offset+=5,this.setContent(this.infiniteContent,this.searchParam,"",5,this.offset,this.categoryImg))}))}mountImg(t,e){if(!t.length){if(document.querySelector("#end"))return;return this.mainContent.insertAdjacentHTML("beforeend",'<div class="img" id="end"><span>Sorry, this is end ...</span></div>')}e?t.map((({gif:{images:{original:{url:t}},id:e}})=>this.paintImg(t,e))):t.map((({images:{downsized:{url:t}},id:e})=>this.paintImg(t,e)))}paintImg(t,e){let i=`<div class="img"><img src="${t}" alt="${e}" /></div>`;this.mainContent.insertAdjacentHTML("beforeend",i)}}).start()})();